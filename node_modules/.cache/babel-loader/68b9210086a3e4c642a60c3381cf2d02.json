{"ast":null,"code":"import auth0 from 'auth0-js';\nexport default class Auth {\n  constructor(history) {\n    this.login = () => {\n      this.auth0.authorize();\n    };\n\n    this.handleAuthentication = () => {\n      this.auth0.parseHash((err, authResult) => {\n        if (authResult && authResult.accessToken && authResult.idToken) {\n          this.setSession(authResult);\n          this.history.push(\"/\");\n        } else if (err) {\n          this.history(\"/\");\n          alert(`Error: ${err.error}. Check console. for further details`);\n          console.log(err);\n        }\n      });\n    };\n\n    this.setSession = authResult => {\n      // set token expiry / convert to epoch format\n      const expiresAt = JSON.stringify(authResult.expiresIN * 1000 + new Date().getTime());\n      localStorage.setItem(\"access_token\", authResult.accessToken);\n      localStorage.setItem(\"id_token\", authResult.idToken);\n      localStorage.setItem(\"expires_at\", expiresAt);\n    };\n\n    this.history = history;\n    this.auth0 = new auth0.WebAuth({\n      domain: process.env.REACT_APP_AUTH0_DOMAIN,\n      clientID: process.env.REACT_APP_AUTH0_CLIENT_ID,\n      redirectUri: process.env.REACT_APP_AUTH0_CALLBACK_URL,\n      responseType: \"token id_token\",\n      scope: \"openid profile email\"\n    });\n  }\n\n}","map":{"version":3,"sources":["/Users/rupertpaterson/Monash_Bootcamp/React Auth0/dashboard/src/Auth/Auth.js"],"names":["auth0","Auth","constructor","history","login","authorize","handleAuthentication","parseHash","err","authResult","accessToken","idToken","setSession","push","alert","error","console","log","expiresAt","JSON","stringify","expiresIN","Date","getTime","localStorage","setItem","WebAuth","domain","process","env","REACT_APP_AUTH0_DOMAIN","clientID","REACT_APP_AUTH0_CLIENT_ID","redirectUri","REACT_APP_AUTH0_CALLBACK_URL","responseType","scope"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,UAAlB;AAEA,eAAe,MAAMC,IAAN,CAAW;AACtBC,EAAAA,WAAW,CAACC,OAAD,EAAU;AAAA,SAWrBC,KAXqB,GAWb,MAAM;AACZ,WAAKJ,KAAL,CAAWK,SAAX;AACD,KAboB;;AAAA,SAerBC,oBAfqB,GAeE,MAAM;AAC3B,WAAKN,KAAL,CAAWO,SAAX,CAAqB,CAACC,GAAD,EAAMC,UAAN,KAAqB;AACxC,YAAIA,UAAU,IAAIA,UAAU,CAACC,WAAzB,IAAwCD,UAAU,CAACE,OAAvD,EAAgE;AAC9D,eAAKC,UAAL,CAAgBH,UAAhB;AACA,eAAKN,OAAL,CAAaU,IAAb,CAAkB,GAAlB;AACD,SAHD,MAGO,IAAIL,GAAJ,EAAS;AACd,eAAKL,OAAL,CAAa,GAAb;AACAW,UAAAA,KAAK,CAAE,UAASN,GAAG,CAACO,KAAM,sCAArB,CAAL;AACAC,UAAAA,OAAO,CAACC,GAAR,CAAYT,GAAZ;AACD;AACF,OATD;AAUD,KA1BoB;;AAAA,SA2BrBI,UA3BqB,GA2BRH,UAAU,IAAI;AACzB;AACA,YAAMS,SAAS,GAAGC,IAAI,CAACC,SAAL,CAChBX,UAAU,CAACY,SAAX,GAAuB,IAAvB,GAA8B,IAAIC,IAAJ,GAAWC,OAAX,EADd,CAAlB;AAGAC,MAAAA,YAAY,CAACC,OAAb,CAAqB,cAArB,EAAqChB,UAAU,CAACC,WAAhD;AACAc,MAAAA,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiChB,UAAU,CAACE,OAA5C;AACAa,MAAAA,YAAY,CAACC,OAAb,CAAqB,YAArB,EAAmCP,SAAnC;AACD,KAnCoB;;AACnB,SAAKf,OAAL,GAAeA,OAAf;AACA,SAAKH,KAAL,GAAa,IAAIA,KAAK,CAAC0B,OAAV,CAAkB;AAC7BC,MAAAA,MAAM,EAAEC,OAAO,CAACC,GAAR,CAAYC,sBADS;AAE7BC,MAAAA,QAAQ,EAAEH,OAAO,CAACC,GAAR,CAAYG,yBAFO;AAG7BC,MAAAA,WAAW,EAAEL,OAAO,CAACC,GAAR,CAAYK,4BAHI;AAI7BC,MAAAA,YAAY,EAAE,gBAJe;AAK7BC,MAAAA,KAAK,EAAE;AALsB,KAAlB,CAAb;AAOD;;AAVqB","sourcesContent":["import auth0 from 'auth0-js';\n\nexport default class Auth {\n    constructor(history) {\n      this.history = history;\n      this.auth0 = new auth0.WebAuth({\n        domain: process.env.REACT_APP_AUTH0_DOMAIN,\n        clientID: process.env.REACT_APP_AUTH0_CLIENT_ID,\n        redirectUri: process.env.REACT_APP_AUTH0_CALLBACK_URL,\n        responseType: \"token id_token\",\n        scope: \"openid profile email\"\n      });\n    }\n  \n    login = () => {\n      this.auth0.authorize();\n    };\n\n    handleAuthentication = () => {\n      this.auth0.parseHash((err, authResult) => {\n        if (authResult && authResult.accessToken && authResult.idToken) {\n          this.setSession(authResult);\n          this.history.push(\"/\");\n        } else if (err) {\n          this.history(\"/\");\n          alert(`Error: ${err.error}. Check console. for further details`);\n          console.log(err);\n        }\n      });\n    };\n    setSession = authResult => {\n      // set token expiry / convert to epoch format\n      const expiresAt = JSON.stringify(\n        authResult.expiresIN * 1000 + new Date().getTime()\n      );\n      localStorage.setItem(\"access_token\", authResult.accessToken);\n      localStorage.setItem(\"id_token\", authResult.idToken);\n      localStorage.setItem(\"expires_at\", expiresAt);\n    };\n}"]},"metadata":{},"sourceType":"module"}